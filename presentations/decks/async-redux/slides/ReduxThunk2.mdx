import {
CodeSurfer,
CodeSurferColumns,
Step,
} from "code-surfer"

import { Layout1 } from '../../../Components/Layout.jsx'

<CodeSurfer>

```tsx title="Redux Thunk" subtitle="manual way" showNumbers
type Todo = {
  userId: number
  id: number
  title: string
  completed: boolean
}

export type TodosState = {
  todos: Array<Todo>
  loading: boolean
}

const initialState: TodosState = {
  todos: [],
  loading: false,
}

const fetchTodos = createAction('TODOS_FETCH')
const fetchTodosSuccess = createAction<Array<Todo>>(
  'TODOS_FETCH_SUCCESS'
)
const fetchTodosFailure = createAction(
  'TODOS_FETCH_FAILURE'
)

export const fetchTodosThunk = () => async (
  dispatch: ThunkDispatch<TodosState, any, Action<any>>
) => {
  dispatch(fetchTodos)
  try {
    const response = await fetch(
      'https://jsonplaceholder.typicode.com/users/1/todos'
    )
    const todos = await response.json()

    dispatch(fetchTodosSuccess(todos))
  } catch {
    dispatch(fetchTodosFailure())
  }
}

const todosSlice = createSlice({
  name: 'todos',
  initialState,
  reducers: {},

  // We use extraReducers to handle actions which where not defined inside the slices "reducers"
  extraReducers: (builder) => {
    builder
      .addCase(fetchTodos, (state, _action) => {
        return { ...state, loading: true }
      })
      .addCase(fetchTodosSuccess, (_state, action) => {
        return { todos: action.payload, loading: false }
      })
      .addCase(fetchTodosFailure, (_state, _action) => {
        return { todos: [], loading: false }
      })
  },
})
```

```diff 1:6

```

```diff 8:11

```

```diff 13:16

```

```diff 18:24

```

```diff 26:40

```

```diff 42:60

```

```diff 50

```

```diff 53

```

```diff 56

```

```tsx title="Redux Thunk" subtitle="using createAsyncThunk()" showNumbers
import { createAsyncThunk } from '@reduxjs/toolkit'

type Todo = {
  userId: number
  id: number
  title: string
  completed: boolean
}

export type TodosState = {
  todos: Array<Todo>
  loading: boolean
}

const initialState: TodosState = {
  todos: [],
  loading: false,
}

export const fetchTodos = createAsyncThunk(
  'todos/fetch',
  async () => {
    const response = await fetch(
      'https://jsonplaceholder.typicode.com/users/1/todos'
    )
    const todos = await response.json()
    return todos
  }
)

const todosSlice = createSlice({
  name: 'todos',
  initialState,
  reducers: {},

  // We use extraReducers to handle actions which where not defined inside the slices "reducers"
  extraReducers: (builder) => {
    builder
      .addCase(fetchTodos.pending, (state, _action) => {
        return { ...state, loading: true }
      })
      .addCase(fetchTodos.fulfilled, (_state, action) => {
        return { todos: action.payload, loading: false }
      })
      .addCase(fetchTodos.rejected, (_state, _action) => {
        return { todos: [], loading: false }
      })
  },
})
```

```diff 1

```

```diff 20:29

```

```diff 31:49

```

```diff 39

```

```diff 42

```

```diff 45

```

</CodeSurfer>
